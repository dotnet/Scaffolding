{
    "Files": [
        {
            "FileName": "Program.cs",
            "Methods": {
                "Global": {
                  "CodeChanges": [
                    {
                      "InsertBefore": [ "var app = WebApplication.CreateBuilder.Build();" ],
                      "MultiLineBlock": [
                        "builder.Services.AddAuthentication(OpenIdConnectDefaults.AuthenticationScheme)",
                        "    .AddMicrosoftIdentityWebApp(builder.Configuration.GetSection(\"AzureAd\"))"
                      ],
                      "LeadingTrivia": {
                        "Newline": true
                      }
                    },
                    {
                      "InsertBefore": [ "var app = WebApplication.CreateBuilder.Build();" ],
                      "Block": "builder.Services.AddCascadingAuthenticationState();",
                      "LeadingTrivia": {
                        "Newline": true
                      }
                    },
                    {
                      "InsertBefore": [ "var app = WebApplication.CreateBuilder.Build();" ],
                      "MultiLineBlock": [
                        "builder.Services.AddAuthorization(options =>",
                        "{",
                        "    // By default, all incoming requests will be authorized according to the default policy.",
                        "    options.FallbackPolicy = options.DefaultPolicy;",
                        "})"
                      ],
                      "LeadingTrivia": {
                        "Newline": true
                      }
                    },
                    {
                      "InsertBefore": [ "app.MapRazorComponents<App>()" ],
                      "Block": "app.MapGroup(\"/authentication\").MapLoginAndLogout()",
                      "LeadingTrivia": {
                        "Newline": true
                      }
                    }
                  ]
                }
            },
            "Usings": [
                "Microsoft.AspNetCore.Authentication.OpenIdConnect",
                "Microsoft.Identity.Web"
            ]
        },
        {
            "FileName": "Components\\_Imports.razor",
            "Replacements": [
                {
                    "ReplaceSnippet": [
                        "@using Microsoft.AspNetCore.Components.Forms"
                    ],
                    "MultiLineBlock": [
                        "@using Microsoft.AspNetCore.Components.Forms",
                        "@using Microsoft.AspNetCore.Components.Authorization"
                    ],
                    "CheckBlock": "Microsoft.AspNetCore.Components.Authorization"
                }
            ]
        },
        {
            "FileName": "Components\\Layout\\MainLayout.razor",
            "Replacements": [
                {
                    "CheckBlock": "<AuthorizeView>",
                    "ReplaceSnippet": [
                        "<div class=\"top-row px-4\">"
                    ],
                    "MultiLineBlock": [
                        "<div class=\"top-row px-4 auth\">",
                        "            <AuthorizeView>",
                        "                <Authorized>",
                        "                    @context.User.Identity?.Name",
                        "                </Authorized>",
                        "            </AuthorizeView>"
                    ]
                }
            ]
        }
    ]
}
